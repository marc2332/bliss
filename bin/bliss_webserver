#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
# This file is part of the bliss project
#
# Copyright (c) 2016 Beamline Control Unit, ESRF
# Distributed under the GNU LGPLv3. See LICENSE for more info.

import os
import optparse
import logging
import bliss
from bliss.shell import set_shell_config_file
from bliss.shell.web import bliss_webserver

usage = "usage: \%prog [-p<port>] [-c<config file>]" 
parser = optparse.OptionParser(usage)
parser.add_option(
     '-p', '--port', dest='port', type='int',
     help='Port to listen on (default 8099)', default=8099, action='store')
parser.add_option('-c', '--config-file', dest='config_file', type='string',
                  help='Configuration file', default=None, action='store')
options, args = parser.parse_args()

logging.basicConfig()
logging.getLogger().setLevel(logging.DEBUG)

if options.config_file:
    set_shell_config_file(options.config_file)
bliss_webserver.serve_forever(options.port) 

